{"version":3,"sources":["../../../app/routes/plants.js"],"names":["express","require","router","Router","bodyParser","sleep","time","stop","Date","getTime","use","urlencoded","extended","get","req","res","render","pageTitle","post","getConnection","error","con","query","body","err","result","string","JSON","stringify","json","parse","redirect","params","plantid","ok","module","exports"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,SAASF,QAAQG,MAAR,EAAb;AACA,IAAIC,aAAaH,QAAQ,aAAR,CAAjB;;AAEA,SAASI,KAAT,CAAeC,IAAf,EAAqB;AACjB,QAAIC,OAAO,IAAIC,IAAJ,GAAWC,OAAX,EAAX;AACA,WAAM,IAAID,IAAJ,GAAWC,OAAX,KAAuBF,OAAOD,IAApC,EAA0C;AACtC;AACH;AACJ;;AAEDJ,OAAOQ,GAAP,CAAWN,WAAWO,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAX;;AAEAV,OAAOW,GAAP,CAAW,qBAAX,EAAkC,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC5CA,QAAIC,MAAJ,CAAW,aAAX,EAAyB;AACrBC,mBAAY;AADS,KAAzB;AAGH,CAJD;;AAMAf,OAAOgB,IAAP,CAAY,qBAAZ,EAAmC,UAACJ,GAAD,EAAMC,GAAN,EAAc;AAC7CD,QAAIK,aAAJ,CAAkB,UAACC,KAAD,EAAQC,GAAR,EAAgB;AAC9BA,YAAIC,KAAJ,CAAU,wCAAwCR,IAAIS,IAAJ,CAAS,MAAT,CAAxC,GAA2D,KAArE,EAA4E,UAACC,GAAD,EAAMC,MAAN,EAAiB;AACzF,gBAAID,GAAJ,EAAS,MAAMA,GAAN;AACTH,gBAAIC,KAAJ,CAAU,yBAAV,EAAqC,UAACE,GAAD,EAAMC,MAAN,EAAiB;AAClD,oBAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,oBAAIE,SAASC,KAAKC,SAAL,CAAeH,MAAf,CAAb;AACA,oBAAII,OAAOF,KAAKG,KAAL,CAAWJ,MAAX,CAAX;AACAL,oBAAIC,KAAJ,CAAU,mHAAmHO,KAAK,CAAL,EAAQ,kBAAR,CAAnH,GAAiJ,gDAA3J,EAA6M,UAACL,GAAD,EAAMC,MAAN,EAAiB;AAC1N,wBAAID,GAAJ,EAAS,MAAMA,GAAN;AACZ,iBAFD;AAGH,aAPD;AAQH,SAVD;AAWH,KAZD;AAaAT,QAAIgB,QAAJ,CAAa,GAAb;AACH,CAfD;;AAiBA7B,OAAOW,GAAP,CAAW,8BAAX,EAA2C,UAACC,GAAD,EAAMC,GAAN,EAAc;AACrDA,QAAIC,MAAJ,CAAW,aAAX,EAAyB;AACrBC,mBAAY;;AADS,KAAzB;AAIH,CALD;;AAOAf,OAAOgB,IAAP,CAAY,8BAAZ,EAA6C,UAACJ,GAAD,EAAMC,GAAN,EAAc;AACvDD,QAAIK,aAAJ,CAAkB,UAACC,KAAD,EAAQC,GAAR,EAAgB;AAC9BA,YAAIC,KAAJ,CAAU,4CAA4CR,IAAIkB,MAAJ,CAAWC,OAAvD,GAAiE,IAA3E,EAAiF,UAACT,GAAD,EAAMC,MAAN,EAAiB;AAC9F,gBAAID,GAAJ,EAAS,MAAMA,GAAN;AACZ,SAFD;AAGAH,YAAIC,KAAJ,CAAU,kCAAkCR,IAAIkB,MAAJ,CAAWC,OAA7C,GAAuD,IAAjE,EAAuE,UAACT,GAAD,EAAMC,MAAN,EAAiB;AACpF,gBAAID,GAAJ,EAAS,MAAMA,GAAN;AACZ,SAFD;AAGH,KAPD;AAQAT,QAAImB,EAAJ;AACH,CAVD;;AAYAhC,OAAOW,GAAP,CAAW,4BAAX,EAAyC,UAACC,GAAD,EAAMC,GAAN,EAAc;AACnDA,QAAIC,MAAJ,CAAW,WAAX,EAAuB;AACnBC,mBAAY;AADO,KAAvB;AAGH,CAJD;;AAMAf,OAAOgB,IAAP,CAAY,4BAAZ,EAA2C,UAACJ,GAAD,EAAMC,GAAN,EAAc;AACrDD,QAAIK,aAAJ,CAAkB,UAACC,KAAD,EAAQC,GAAR,EAAgB;AAC9BA,YAAIC,KAAJ,CAAU,4CAA4CR,IAAIkB,MAAJ,CAAWC,OAAvD,GAAiE,IAA3E,EAAiF,UAACT,GAAD,EAAMC,MAAN,EAAiB;AAC9F,gBAAID,GAAJ,EAAS,MAAMA,GAAN;AACZ,SAFD;AAGAH,YAAIC,KAAJ,CAAU,kCAAkCR,IAAIkB,MAAJ,CAAWC,OAA7C,GAAuD,IAAjE,EAAuE,UAACT,GAAD,EAAMC,MAAN,EAAiB;AACpF,gBAAID,GAAJ,EAAS,MAAMA,GAAN;AACZ,SAFD;AAGH,KAPD;AAQH,CATD;;AAWAW,OAAOC,OAAP,GAAiBlC,MAAjB","file":"plants.js","sourcesContent":["let express = require('express');\nlet router = express.Router();\nlet bodyParser = require('body-parser');\n\nfunction sleep(time) {\n    var stop = new Date().getTime();\n    while(new Date().getTime() < stop + time) {\n        ;\n    }\n}\n\nrouter.use(bodyParser.urlencoded({ extended: true }));\n\nrouter.get('/plants/createPlant', (req, res) => {\n    res.render('createPlant',{\n        pageTitle : \"Create Plant\"\n    });\n});\n\nrouter.post('/plants/createPlant', (req, res) => {\n    req.getConnection((error, con) => {\n        con.query('INSERT INTO plant (name) VALUES (\\'' + req.body['name'] + '\\')', (err, result) => {\n            if (err) throw err;\n            con.query('SELECT LAST_INSERT_ID()', (err, result) => {\n                if (err) throw err;\n                let string = JSON.stringify(result);\n                let json = JSON.parse(string);\n                con.query('INSERT INTO conditions (plantID, time, lightIntensity, soilHumidity, soilTemperature, airTemperature) VALUES (' + json[0]['LAST_INSERT_ID()'] + ', \\'2018-01-19 01:00:00\\', 5.0, 5.0, 5.0, 5.0)', (err, result) => {\n                    if (err) throw err;\n                });\n            });\n        });\n    });\n    res.redirect('/');\n});\n\nrouter.get('/plants/deletePlant/:plantid', (req, res) => {\n    res.render('deletePlant',{\n        pageTitle : \"Delete Plant\"\n\n    });\n});\n\nrouter.post('/plants/deletePlant/:plantid',  (req, res) => {\n    req.getConnection((error, con) => {\n        con.query('DELETE FROM conditions where plantID = ' + req.params.plantid + ' ;', (err, result) => {\n            if (err) throw err;\n        });\n        con.query('DELETE FROM plant where id = ' + req.params.plantid + ' ;', (err, result) => {\n            if (err) throw err;\n        });\n    });\n    res.ok;\n});\n\nrouter.get('/plants/editPlant/:plantid', (req, res) => {\n    res.render('editPlant',{\n        pageTitle : \"Edit Plant\"\n    });\n});\n\nrouter.post('/plants/editPlant/:plantid',  (req, res) => {\n    req.getConnection((error, con) => {\n        con.query('DELETE FROM conditions where plantID = ' + req.params.plantid + ' ;', (err, result) => {\n            if (err) throw err;\n        });\n        con.query('DELETE FROM plant where id = ' + req.params.plantid + ' ;', (err, result) => {\n            if (err) throw err;\n        });\n    });\n});\n\nmodule.exports = router;\n"]}